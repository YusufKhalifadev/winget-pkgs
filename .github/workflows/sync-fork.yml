name: Sync with upstream

on:
  schedule:
    - cron: "0 */6 * * *"   # every 6 hours
  workflow_dispatch:

permissions:
  contents: write

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout fork
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Sync fork from upstream
        uses: aormsby/Fork-Sync-With-Upstream-action@v3.4
        with:
          upstream_sync_repo: microsoft/winget-pkgs
          upstream_sync_branch: master

          # IMPORTANT: set this explicitly (cron runs have no branch context)
          target_sync_branch: master  # change to 'main' if your fork default is main

          # Token for pushing to YOUR fork
          target_repo_token: ${{ secrets.GITHUB_TOKEN }}

          # Keep history clean; fails if your branch has local commits not in upstream
          upstream_pull_args: --ff-only
